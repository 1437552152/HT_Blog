<!--
 * @Description: 
 * @Author: yfye
 * @Date: 2021-06-05 16:59:35
 * @LastEditTime: 2021-06-17 23:47:43
 * @LastEditors: yfye
-->
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>我的资料</title>
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/home.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdn.staticfile.org/fingerprintjs2/2.1.0/fingerprint2.min.js"></script>
    <!--[if lt IE 9]>
	<script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
	<![endif]-->
</head>

<body>
    <div id="app" v-cloak>
        {% include "public/header.html" %}
        <div class="w1200 m40">
            <aside style="width: 200px;">
                {% include "public/myUser.html" %}
            </aside>
            <div class="content" style="width: 950px;">
                <el-form ref="form" :model="sizeForm" label-width="80px" size="mini" :rules="rules" ref="sizeForm"
                    status-icon>
                    <el-form-item label="上传头像" ref="uploadElement" prop="imageUrl">
                        <el-input v-model="sizeForm.imageUrl" v-if="false"></el-input>
                        <el-upload class="avatar-uploader" ref="upload" :show-file-list="false" action="/index/upload"
                            :before-upload="beforeUpload" :on-change="handleChange" :auto-upload="false"
                            :data="sizeForm">
                            <img v-if="sizeForm.imageUrl" :src="sizeForm.imageUrl" class="avatar">
                            <i v-else class="el-icon-plus avatar-uploader-icon"></i>
                        </el-upload>
                    </el-form-item>

                    <el-form-item label="账号昵称" prop="nickName">
                        <el-input v-model="sizeForm.nickName"></el-input>
                    </el-form-item>

                    <el-form-item label="邮箱" prop="email">
                        <el-input v-model="sizeForm.email"></el-input>
                    </el-form-item>

                    <el-form-item label="手机号" prop="phone">
                        <el-input v-model="sizeForm.phone"></el-input>
                    </el-form-item>

                    <el-form-item label="微信号" prop="weChat">
                        <el-input v-model="sizeForm.weChat"></el-input>
                    </el-form-item>

                    <el-form-item size="large">
                        <el-button type="primary" @click="submitForm('sizeForm')">保存</el-button>
                    </el-form-item>
                </el-form>
            </div>
        </div>
        {% include "public/footer.html" %}
    </div>
</body>
<script src="/js/vue.js"></script>
<script src="/js/index.js"></script>
<script src="/js/oper.js"></script>
<script>
    $(function () {
        new Vue({
            el: '#app',
            data: function () {
                var validatePass1 = (rule, value, callback) => {
                    var reg = /^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;
                    if (value === '') {
                        callback(new Error('请输入邮箱'));
                    } else if (!reg.test(value)) {
                        callback(new Error('邮箱格式不正确!'));
                    } else {
                        callback();
                    }
                };

                var validatePass2 = (rule, value, callback) => {
                    var reg = /^[1][3,4,5,6,7,8,9][0-9]{9}$/;
                    if (value === '') {
                        callback(new Error('请输入手机号'));
                    } else if (!reg.test(value)) {
                        callback(new Error('手机号格式不正确!'));
                    } else {
                        callback();
                    }
                };
                return {
                    activeName: 'second',
                    sizeForm: {
                        nickName: '',
                        email: '',
                        phone: '',
                        weChat: '',
                        imageUrl: '',
                    },
                    rules: {
                        email: [
                            { validator: validatePass1, trigger: 'blur' }
                        ],
                        phone: [
                            { validator: validatePass2, trigger: 'blur' }
                        ],
                        imageUrl: [
                            { required: true, message: '请上传头像', trigger: 'blur' },
                        ],
                    }
                }
            },
            methods: {
                handleChange(file, fileList) {
                    this.ruleForm.imageUrl = URL.createObjectURL(file.raw);
                },

                beforeUpload(file) {
                    return true;
                },
                submitForm(formName) {
                    let vm = this;
                    this.$refs[formName].validate((valid) => {
                        if (valid) {
                            vm.$refs.upload.submit();
                        } else {
                            return false;
                        }
                    });
                }
            }
        })
    })

</script>

<style>
    input[type="file"] {
        display: none;
    }

    .avatar-uploader .el-upload {
        border: 1px dashed #d9d9d9;
        border-radius: 6px;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .avatar-uploader .el-upload:hover {
        border-color: #409EFF;
    }

    .avatar-uploader-icon {
        font-size: 28px;
        color: #8c939d;
        width: 178px;
        height: 178px;
        line-height: 178px;
        text-align: center;
    }

    .avatar {
        width: 178px;
        height: 178px;
        display: block;
    }
</style>

</html>